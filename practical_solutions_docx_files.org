#+title: Handling docx files in Emacs
[2022-12-24 Sat]

doc-view-mode

install pandoc

apt install docx2txt

#+begin_src emacs-lisp
(add-to-list 'auto-mode-alist '("\\.docx\\'" . docx2txt))

(defun docx2txt ()
 "Run docx2txt on the entire buffer."
 (shell-command-on-region (point-min) (point-max) "docx2txt" t t))

(provide 'docx2txt)
#+end_src

#+begin_src emacs-lisp
  ;; ================================
  ;; ;; CONVERT DOCX TO MARKDOWN
  (defun dired-pandoc-docx-md ()
    (interactive)
    (dired-do-async-shell-command
     "pandoc -f docx -t markdown --wrap=none" current-prefix-arg
     (dired-get-marked-files t current-prefix-arg)))
  ;; and to do the same with odt files
  (defun dired-pandoc-odt-md ()
    (interactive)
    (dired-do-async-shell-command
     "pandoc -f odt -t markdown --wrap=none" current-prefix-arg
     (dired-get-marked-files t current-prefix-arg)))
#+end_src

#+begin_src emacs-lisp
(use-package ox-pandoc
  :ensure t
  :config
  (require 'ox-pandoc)
  )
#+end_src
